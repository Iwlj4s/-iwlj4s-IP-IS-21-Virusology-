<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Вирусология</title>
    <link rel="stylesheet" href="css/styleH.css">
    <link rel="stylesheet" href="css/styleP.css">
    <link rel="stylesheet" href="css/stylenav.css">
    <link rel="stylesheet" href="css/styleimg.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <link rel="shortcut icon" href="img/virus.png" type="image/x-icon" />
    <style>
        .scale {
         transition: 1s; 
        }
        .scale:hover {
         transform: scale(1.2); 
        }
        .navbar-nav {
         max-width: 80%;
}
       </style>
</head>
<header class="header">
    <nav class=" navbar  navbar-collapse navbar-light bg-light">
      <div class="container">
        <a class="navbar-brand p-0" href="" >
          <img width="120" src="img/emb.png"  alt="" />
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
          aria-controls="navbarNav"
          aria-expanded="false"
          aria-label="Toggle navigation"
          position=""
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav">
            <li class="nav-item">
            </li>
            <a class="list-group-item list-group-item-action"  href="njrat.html">nj.RAT</a>
            <li class="nav-item">
              <li class="nav-item">
                <a class="list-group-item list-group-item-action"  href="Qrcode.html"> QR Code </a>
              </li>
              <li class="nav-item">
                <a class="list-group-item list-group-item-action"  href="#">Wanna Cry</a>
              </li>
              <li class="nav-item">
                <a class="list-group-item list-group-item-action"  href="final.html">Итог</a>
              </li>
              <li class="nav-item">
                <a class="list-group-item list-group-item-action" href="used info.html">Used Info</a>
              </li>
          </ul>
        </div>
      </div>
    </header>
    <h1> <b>Вирусология </b></h1>
    <h2><b>Wanna Cry</b></h2>
    <p class="col-lg-8 mx-auto"><u>12.05.2017</u> более чем 75000 компьютеров на Windows по всему миру пострадали от атаки червя-вымогателя, известного как WannaCry, WCry или WanaCrypt0r 2.0.</p>
    <p class="col-lg-8 mx-auto">WannaCry стал одним из первых червей-вымогателей. Данное зловредное программное обеспечение не только работает как вымогатель, но и пытается инфицировать как можно больше систем в сети, сканируя сеть, где он оказался, и заражая соседние компьютеры.<br> Данную атаку очень тяжело обнаружить традиционными системами безопасности, потому что он скрытно использует недавно обнаруженную уязвимость в операционных системах Microsoft. После проникновения в систему WannaCry шифрует все локальные диски и сетевые папки. Именно функционал компьютерного червя делают данную атаку такой опасной для компаний и частных пользователей, потому что распространение его происходит через два источника – зараженное вложение в электронной почте и распространение как компьютерный червь.</p>
     <h2><b>Жертвы</b></h2>   
    <p class="col-lg-8 mx-auto">Киберпреступники специально выбирали жертв для атаки из компаний, которые не могут простить себе простоя и, вероятнее всего, предпочтут быстро заплатить выкуп: телекоммуникационные, логистические и энергетические компании, общественный транспорт, больницы, школы и университеты. Злоумышленники не побоялись атаковать даже подразделения МВД России.<br><br> Краткий список компаний-жертв атаки червя-вымогателя:</p>       
      <ul>
        <li>ациональная служба здравоохранения Великобритании NHS переносит прием пациентов, т.к. не может проводить диагностику больных. (Список пострадавших больниц)</li>
        <li>Завод Nissan в Великобритании</li>
        <li>Телекоммуникационная компания Telefonica в Испании</li>
        <li>Энергетические компании Iberdrola и Gas Natural</li>
        <li>Логистическая компания FedE</li>
        <li>Университет Ватерлоо</li>
        <li>МВД и Мегафон в России</li>
        <li>ВТБ</li>
        <li>Российские Железные Дороги</li>
        <li>Португальская телекоммуникационная компания Portugal Telecom</li>
        <li>Сбербанк Россия (крупнейший банк в России)</li>
        <li>Индийская авиакомпания Shaheen Airlines</li>
        <li>Немецкая железная дорога Deutche Bahn</li>
        <li>Школы и университеты в Китае</li>
        <li>Библиотека Омана</li>
        <li>Бюро общественной безопасности провинции Яаншуи в Китае</li>
        <li>Автопроизводитель Renault во Франции</li>
        <li>Школы во Франции</li>
        <li>Университет Милано-Бикокка (Италия)</li>
        <li>Торговый центр в Сингапуре</li>
        <li>Банкоматы в Китае</li>
        <li>Телекоммуникационная компания Саудовской Аравии и ряда других стран STC telecom </li>
      </ul>
      <p class="col-lg-8 mx-auto">Червь-вымогатель WannaCry проникает в частные и корпоративные сети с помощью рассылок нежелательной почты, которая содержит вредоносные вложения, которые, в свою очередь, содержат макрос или ссылку на вредоносную программу, начинающую первоначальное заражение. И хотя на текущий момент нет примеров таких писем, все аналитики, включая экспертов Microsoft, сходятся в том, что именно таким образом происходило заражение на первом этапе.</p>
       <p class="col-lg-8 mx-auto">Перед началом своей активности, WannaCry проверяет существование специального домена «выключателя» и если он находит его, то программа прекращает свою работу. Первая версия червя была остановлена именно путем активации такого домена «выключателя». Если же «выключатель» не существует, то червь начинает загрузку своих модулей, регистрирует сервис, сканирует случайные IP-адреса по порту 445, проверяет наличие бекдора DOUBLEPULSAR и подготавливает пакет для внедрения.<br>Процесс подготовки пакета для внедрения реализован в виде функции, которую мы называем initNetworkInjectingExecutables в псевдокоде ниже. initNetworkInjectingExecutables читает DLL-загрузчик из червя, создает пакет для внедрения, добавляет к нему червя и пересылает на скомпрометированный системный порт. На этой системе загрузчик получает контроль через бекдор DOUBLEPULSAR и запускает червь.</p>
      <p id="opredBaD" class="col-lg-8 mx-auto">Бэкдор, тайный вход — дефект алгоритма, который намеренно встраивается в него разработчиком и позволяет получить несанкционированный доступ к данным или удалённому управлению операционной системой и компьютером в целом.</p>
      <p class="col-lg-8 mx-auto">При использовании ETERNALBLUE происходит внедрение DOUBLEPULSAR в систему и DOUBLEPULSAR использует уязвимость драйвера режима ядра ОС SRV.SYS (файловый сервер SMB), которая позволяет встроить и выполнить код опасной DLL в любом процессе на скомпрометированной системе.</p>
      <br><p class="col-lg-8 mx-auto">После установки вредоносной программы, она начинает действовать как программа-червь, сканируя сеть и подключаясь по порту 445 к другим компьютерам для обнаружения работающих бекдоров DOUBLEPULSAR, передает зараженные файлы, которые запускают процесс на новом компьютере, распространяя инфекцию подобно пожару в лесу. Если же атакованная система не содержит бекдора DOUBLEPULSAR, то червь сначала устанавливает его через эксплоит ETERNALBLUE, и процесс продолжается.</p>
      <p id="opredEtBl" class="col-lg-8 mx-auto">эксплойт EternalBlue позволяет отправить специальный пакет по протоколу SMB v1, после чего тот кто отправил получает доступ к системе и может запустить на ней свой код.</p>
      <p id="opredSMB" class="col-lg-8 mx-auto">SMB (Server Message Block) — это сетевой протокол прикладного уровня для удалённого доступа к файлам, принтерам и другим сетевым ресурсам, а также для межпроцессного взаимодействия. Первая версия протокола, также известная как Common Internet File System (CIFS) (Единая файловая система Интернета). В настоящее время SMB связан главным образом с операционными системами Microsoft Windows, где используется для реализации «Сети Microsoft Windows» (Microsoft Windows Network) и «Совместного использования файлов и принтеров» (File and Printer Sharing).</p>
      <p id="opredBbPl" class="col-lg-8 mx-auto">DoublePulsar — бэкдор, разработанный группировкой Equation Group и опубликованный хакерской группой The Shadow Brokers в начале 2017 года.</p>
      <p class="col-lg-8 mx-auto">Зловредное программное обеспечение на инфицированной системе удаляет все теневые копии VSS всеми доступными способами:</p>
      <p id="Dvss" class="col-lg-8 mx-auto">Vssadmin delete shadows /all /quiet<br>
        Wmic shadowcopy delete<br>
        Wbadmin delete catalog –quiet</p>
        <p class="col-lg-8 mx-auto">Так же отключается консоль восстановления на скомпрометированной системе:</p>
        <p id="Dvss" class="col-lg-8 mx-auto">Bcdedit /set {default} bootstatuspolicy ignoreallfailures<br>
            Bcdedit /set {default} recoveryenabled no</p>
        <h2 class="col-lg-8 mx-auto"><b>Как WannaCry шифрует файлы</b></h2>
        <p class="col-lg-8 mx-auto">Вредоносная часть червя запускает по расписанию программу-шифровальщик tasksche.exe, которую она распаковывает из загрузочного пакета.<br> Шифровальщик сканирует все диски и сетевые папки на системе, ищет файлы с расширениями из внутренней таблицы и шифрует их алгоритмом RSA с 2048-битным ключом.<br> В новой папке с именем Tor/ он создает tor.exe и сопутствующие файлы. Туда же копируются два файла: taskdl.exe и taskse.exe. Последняя программа удаляет следы работы червя и далее запускает @wanadecryptor@.exe. Данная программа показывает заставку с требование выкупа и осуществляет связь через сеть Tor.</p>
        <p class="col-lg-8 mx-auto">Шифровальщик шифрует файлы более чем 160 различных расширений:</p>
        <p id="Ss100" class="col-lg-8 mx-auto">.doc, .docx, .xls, .xlsx, .ppt, .pptx, .pst, .ost, .msg, .eml, .vsd, .vsdx, .txt, .csv, .rtf, .123, .wks, .wk1, .pdf, .dwg, .onetoc2, .snt, .jpeg, .jpg, .docb, .docm, .dot, .dotm, .dotx, .xlsm, .xlsb, .xlw, .xlt, .xlm, .xlc, .xltx, .xltm, .pptm, .pot, .pps, .ppsm, .ppsx, .ppam, .potx, .potm, .edb, .hwp, .602, .sxi, .sti, .sldx, .sldm, .sldm, .vdi, .vmdk, .vmx, .gpg, .aes, .ARC, .PAQ, .bz2, .tbk, .bak, .tar, .tgz, .gz, .7z, .rar, .zip, .backup, .iso, .vcd, .bmp, .png, .gif, .raw, .cgm, .tif, .tiff, .nef, .psd, .ai, .svg, .djvu, .m4u, .m3u, .mid, .wma, .flv, .3g2, .mkv, .3gp, .mp4, .mov, .avi, .asf, .mpeg, .vob, .mpg, .wmv, .fla, .swf, .wav, .mp3, .sh, .class, .jar, .java, .rb, .asp, .php, .jsp, .brd, .sch, .dch, .dip, .pl, .vb, .vbs, .ps1, .bat, .cmd, .js, .asm, .h, .pas, .cpp, .c, .cs, .suo, .sln, .ldf, .mdf, .ibd, .myi, .myd, .frm, .odb, .dbf, .db, .mdb, .accdb, .sql, .sqlitedb, .sqlite3, .asc, .lay6, .lay, .mml, .sxm, .otg, .odg, .uop, .std, .sxd, .otp, .odp, .wb2, .slk, .dif, .stc, .sxc, .ots, .ods, .3dm, .max, .3ds, .uot, .stw, .sxw, .ott, .odt, .pem, .p12, .csr, .crt, .key, .pfx, .der</p>
        <p class="col-lg-8 mx-auto">Если система не защищена пользователь увидит неприятное сообщение:</p>
        <img src="img/WCw.png" alt="WcW"class="scale center-pic">
    </div>
    </body>
</html>